---
layout: post
title:  "Golang设计模式-单例模式"
date:   2020-5-14 17:20:00 +0800
categories: go
tags: go
comments: 1
---
##### 定义
```单例模式（Singleton）```，也叫单子模式，是一种常用的软件设计模式。在应用这个模式时，单例对象的类必须保证只有一个实例存在。许多时候整个系统只需要拥有一个的全局对象，这样有利于我们协调系统整体的行为。比如在某个服务器程序中，该服务器的配置信息存放在一个文件中，这些配置数据由一个单例对象统一读取，然后服务进程中的其他对象再通过这个单例对象获取这些配置信息。这种方式简化了在复杂环境下的配置管理。 
##### 需要注意 
单例模式在协程的应用场合下必须小心使用。如果当唯一实例尚未创建时，有两个协程同时调用创建方法，那么它们同时没有检测到唯一实例的存在，从而同时各自创建了一个实例， 这样就有两个实例被构造出来，从而违反了单例模式中实例唯一的原则。 解决这个问题的办法是为指示类是否已经实例化的变量提供一个```互斥锁```(虽然这样会降低效率)。
##### 代码示例

```
    package main

    import (
        "sync"
    )
    var _instance *single
    var once sync.Once

    type single struct {}

    //创建单例模式
    func GetInstance() *single{
        //once 它能保证某个操作仅且只执行一次
        once.Do(func() {
            _instance = &single{}
        })
        return _instance
    }
 ```